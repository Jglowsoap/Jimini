rules:
  - id: JWT-1.0
    title: "JWT token"
    pattern: "\\beyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\b"
    severity: "error"
    action: "block"
    tags: ["secret","token"]
    shadow_override: enforce

  - id: AWS-ACCESS-KEY-1.0
    title: "AWS Access Key ID"
    pattern: "\\bAKIA[0-9A-Z]{16}\\b"
    severity: "error"
    action: "block"
    tags: ["aws","secret"]
    shadow_override: enforce

  - id: AWS-SECRET-KEY-1.0
    title: "AWS Secret Access Key (loose)"
    pattern: "(?i)\\baws(.{0,20})?(secret|sk)[^\\n]{0,5}[:=][^\\n]{20,}\\b"
    severity: "error"
    action: "block"
    tags: ["aws","secret"]
    shadow_override: enforce

  - id: GITHUB-TOKEN-1.0
    title: "GitHub token"
    pattern: "\\bgh[pousr]_[A-Za-z0-9]{30,}\\b"
    severity: "error"
    action: "block"
    tags: ["github","secret"]
    shadow_override: enforce

  - id: SLACK-BOT-1.0
    title: "Slack bot token"
    pattern: "\\bxoxb-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24,}\\b"
    severity: "error"
    action: "block"
    tags: ["slack","secret"]

  - id: OPENAI-KEY-1.0
    title: "OpenAI key"
    pattern: "\\bsk-[a-zA-Z0-9]{20,}\\b"
    severity: "error"
    action: "block"
    tags: ["openai","secret"]
    shadow_override: enforce

  - id: GOOGLE-API-KEY-1.0
    title: "Google API key"
    pattern: "\\bAIza[0-9A-Za-z-_]{35}\\b"
    severity: "error"
    action: "block"
    tags: ["google","secret"]

  - id: SSH-PRIVATE-1.0
    title: "Security: SSH Private Key"
    pattern: "-----BEGIN (?:OPENSSH|RSA|DSA|EC|ED25519) PRIVATE KEY-----[\\s\\S]*?-----END (?:OPENSSH|RSA|DSA|EC|ED25519) PRIVATE KEY-----"
    severity: "error"
    action: "block"
    tags: ["security","credentials","ssh"]
    shadow_override: enforce

  - id: PGP-PRIVATE-1.0
    title: "Security: PGP Private Key"
    pattern: "-----BEGIN PGP PRIVATE KEY BLOCK-----[\\s\\S]*?-----END PGP PRIVATE KEY BLOCK-----"
    severity: "error"
    action: "block"
    tags: ["security","credentials","pgp"]
    shadow_override: enforce

  - id: BASE64-CHUNK-1.0
    title: "Large Base64-encoded blob (exfil heuristic)"
    pattern: "\\b(?:[A-Za-z0-9+/]{80,}={0,2})\\b"
    severity: "warning"
    action: "flag"
    tags: ["exfil","encoding"]
    applies_to: ["outbound"]

  - id: ZIP-LEAK-1.0
    title: "Possible archive leak mention"
    pattern: "(?i)\\b(.+\\.(zip|7z|rar)|compressed archive|password.*zip)\\b"
    severity: "warning"
    action: "flag"
    tags: ["exfil","archive"]
    applies_to: ["outbound"]
